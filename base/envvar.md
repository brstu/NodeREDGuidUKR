## Використання змінних середоивща (environment variables)

[Основне джерело](https://nodered.org/docs/user-guide/environment-variables)

[Додаткове джерело](https://github.com/node-red/node-red/wiki/Design:-Using-environment-variables)

Змінні середовища (environment variables) -- це конфігураційні змінні, які задаються у файлі  `settings.json` безпосередньо, або через "Project Settings" чи налаштування підпотоку. Ці змінні можна використовувати (зчитувати) в середовищі виконання для різноманітних функцій. 

### Встановлення властивості вузлу

Будь-яку властивість вузла можна встановити змінною середовища, встановивши його значення на рядок форми `${ENV_VAR}`. Коли програма виконує завантаження потоків, вона замінить значення цієї змінної середовища перед передачею її у вузол.

Це працює лише в тому випадку, якщо він замінює всю властивість - її не можна використовувати для заміни лише частини значення. Наприклад, *НЕ* можливо використовувати `CLIENT-${HOST}`.

Оскільки вузли надають власне діалогове вікно редагування, не всі властивості забезпечуватимуть введення тексту, яке можна використовувати для введення рядка в форматі env-var. У цьому випадку ви можете розглянути можливість редагування файлу потоку вручну, щоб встановити властивість.

### Використання віджету TypedInput

![TypedInput Environment Variable](https://nodered.org/docs/user-guide/editor/images/editor-typedInput-envvar-expanded.png)

Тип змінної TypedInput Environment 

У редакторі віджетв TypedInput може запропонувати "змінну середовища" як тип. Коли цей тип обраний, його значення буде оцінено наступним чином:

- якщо немає присутнього `${}` , використовує ціле значення поля, як ім'я змінної середовища. Наприклад, `"FOO"` буде замінено значенням `process.env.FOO`
- якщо присутній `${}`, він замінить відповідну змінну середовища на результат: Наприклад, задавши значення `"Hello ${FOO}"`, змінну середоивща `FOO` встановлено на ` World`, це призводить до значення  `"Hello World"`

### JSONata вирази

Environment variables can be accessed in JSONata expressions, such as in the Change node, using the `$env` function:

До змінних середовища можна отримати доступ у виразах JSONata, таких як у вузлі Change, використовуючи функцію `$env`:

```
$env('ENV_VAR')
```

### Вузол Function

У вузлі Function доступ до змінних середовища можна отримати за допомогою функції `env.get`:

```
let foo = env.get("FOO");
```

### Властивості екземпляру Subflow

Починаючи з 0,20, підпотоки можна налаштувати з властивостями екземпляра. Вони відображаються як змінні середовища в підпотоці і можуть бути налаштовані для окремих екзмеплярів підпотоку.

Наприклад, з урахуванням API REST, який забезпечує доступ до записів різних типів, для доступу до API та обробки відповіді може бути створений підпотік, використовуючи змінну середовища, щоб визначити, до якого типу записів слід звертатися. Окремі екземпляри Subflow можуть бути налаштовані під конкретні типи.